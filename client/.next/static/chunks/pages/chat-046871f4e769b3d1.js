(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{22:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return t(2137)}])},2137:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return k}});var a=t(5893),r=t(7294),l=t(9008),i=t.n(l),n=t(1664),c=t.n(n),o=t(8107),d=t(334),m=t(3219),x=t(2958),h=t(713),u=t(1581),p=t(9461),g=t(4933),f=t(5283),j=t(3766),N=t(1352),v=t(4617),b=t(2841),y=t(8885),w=t(6501);function k(){let{selectedProperty:e}=(0,o.W)(),[s,t]=(0,r.useState)([]),[l,n]=(0,r.useState)(""),[k,Z]=(0,r.useState)(!1),[P,A]=(0,r.useState)(null),[F,S]=(0,r.useState)(null),C=(0,r.useRef)(null),D=(0,r.useRef)(null),I=()=>{var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{I()},[s]),(0,r.useEffect)(()=>{e&&s.length>0&&localStorage.setItem("chat-messages-".concat(e.id),JSON.stringify(s))},[s,e]),(0,r.useEffect)(()=>{if(e){let a=localStorage.getItem("chat-messages-".concat(e.id));if(a&&0===s.length)try{let e=JSON.parse(a),s=e.map(e=>({...e,timestamp:new Date(e.timestamp)}));t(s),(0,w.ZP)("Restored previous conversation",{icon:"\uD83D\uDCAC",duration:3e3,style:{background:"rgba(255, 255, 255, 0.1)",color:"#fff",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)"}})}catch(s){console.error("Failed to restore chat messages:",s),localStorage.removeItem("chat-messages-".concat(e.id))}}},[e]);let E=()=>{A(null),S(null),D.current&&(D.current.value="")},z=async()=>{if(!l.trim()&&!P||!e||k)return;let a={role:"user",content:l.trim(),timestamp:new Date,file:P?{name:P.name,type:P.type,size:P.size}:void 0};t(e=>[...e,a]),n(""),E(),Z(!0);try{let r;let l=[...s,a].map(e=>({role:e.role,content:e.content}));if(P){let s=new FormData;s.append("messages",JSON.stringify(l)),s.append("propertyId",e.id.toString()),s.append("file",P),r=await d.R2.sendMessageWithFile(s)}else r=await d.R2.sendMessage(l,e.id);let i={role:"assistant",content:r.data.message,timestamp:new Date};t(e=>[...e,i])}catch(s){var r,i;console.error("Chat error:",s),w.ZP.error((null===(i=s.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.message)||"Failed to send message",{style:{background:"rgba(239, 68, 68, 0.1)",color:"#fca5a5",backdropFilter:"blur(10px)",border:"1px solid rgba(239, 68, 68, 0.3)"}});let e={role:"assistant",content:"Sorry, I encountered an error processing your request. Please try again.",timestamp:new Date};t(s=>[...s,e])}finally{Z(!1)}};return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:"AI Assistant - Encore Architect"}),(0,a.jsx)("meta",{name:"description",content:"Chat with AI assistant for event planning"})]}),(0,a.jsxs)("div",{className:"min-h-screen bg-space-900 flex flex-col relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-mesh-gradient opacity-10 animate-gradient"}),(0,a.jsx)("header",{className:"glass-card-dark border-b border-white/10 px-4 py-4 relative z-10",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(c(),{href:"/",className:"icon-btn mr-4 group",children:(0,a.jsx)(m.Z,{className:"w-5 h-5 text-gray-400 group-hover:text-white transition-colors"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-xl font-semibold text-white flex items-center",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 mr-2 text-primary-400"}),"AI Assistant"]}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.name})]})]}),(0,a.jsxs)("button",{onClick:()=>{t([]),e&&localStorage.removeItem("chat-messages-".concat(e.id)),w.ZP.success("Conversation cleared",{style:{background:"rgba(34, 197, 94, 0.1)",color:"#86efac",backdropFilter:"blur(10px)",border:"1px solid rgba(34, 197, 94, 0.3)"}})},className:"btn-secondary text-sm flex items-center",disabled:0===s.length,children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"New Conversation"]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative z-10",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[0===s.length&&(0,a.jsxs)("div",{className:"text-center py-12 animate-fade-in",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-primary-500/20 to-accent-500/20 flex items-center justify-center mx-auto mb-6 animate-float",children:(0,a.jsx)(u.Z,{className:"w-12 h-12 text-primary-400"})}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-white mb-3",children:"Welcome to the AI Assistant"}),(0,a.jsx)("p",{className:"text-gray-400 mb-8 max-w-md mx-auto",children:"Describe your event requirements in natural language and I'll help you create detailed equipment orders and labor proposals."}),(0,a.jsxs)("div",{className:"glass-card-dark max-w-md mx-auto p-6 text-left",children:[(0,a.jsxs)("h3",{className:"font-medium text-white mb-4 flex items-center",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 mr-2 text-accent-400"}),"Try asking:"]}),(0,a.jsxs)("ul",{className:"text-sm text-gray-300 space-y-3",children:[(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"text-accent-400 mr-2",children:"•"}),'"100 attendees, need audio for a panel in the Grand Ballroom"']}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"text-accent-400 mr-2",children:"•"}),'"Corporate event with projection and wireless mics"']}),(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"text-accent-400 mr-2",children:"•"}),'"Wedding reception with lighting and sound system"']})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:s.map((e,s)=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"," animate-slide-up"),children:(0,a.jsxs)("div",{className:"flex max-w-3xl ".concat("user"===e.role?"flex-row-reverse":"flex-row"),children:[(0,a.jsx)("div",{className:"flex-shrink-0 ".concat("user"===e.role?"ml-3":"mr-3"),children:(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat("user"===e.role?"bg-gradient-to-br from-primary-500 to-primary-600 shadow-glow":"bg-gradient-to-br from-accent-500/20 to-accent-600/20 border border-accent-500/30"),children:"user"===e.role?(0,a.jsx)(g.Z,{className:"w-5 h-5 text-white"}):(0,a.jsx)(u.Z,{className:"w-5 h-5 text-accent-400"})})}),(0,a.jsxs)("div",{className:"".concat("user"===e.role?"chat-message-user":"chat-message-assistant"),children:["assistant"===e.role?(0,a.jsx)("div",{className:"markdown-content",children:(0,a.jsx)(y.UG,{children:e.content})}):(0,a.jsxs)(a.Fragment,{children:[e.file&&(0,a.jsxs)("div",{className:"mb-2 p-2 bg-white/5 rounded inline-flex items-center",children:[e.file.type.startsWith("image/")?(0,a.jsx)(f.Z,{className:"w-4 h-4 text-primary-400 mr-2"}):(0,a.jsx)(j.Z,{className:"w-4 h-4 text-primary-400 mr-2"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:e.file.name})]}),(0,a.jsx)("p",{className:"text-white",children:e.content||"Analyzing file..."})]}),(0,a.jsx)("div",{className:"text-xs mt-3 ".concat("user"===e.role?"text-primary-200":"text-gray-500"),children:e.timestamp.toLocaleTimeString()})]})]})},s))}),k&&(0,a.jsx)("div",{className:"flex justify-start animate-slide-up",children:(0,a.jsxs)("div",{className:"flex max-w-3xl",children:[(0,a.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-accent-500/20 to-accent-600/20 border border-accent-500/30 flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"w-5 h-5 text-accent-400 animate-pulse"})})}),(0,a.jsx)("div",{className:"chat-message-assistant",children:(0,a.jsxs)("div",{className:"loading-dots",children:[(0,a.jsx)("div",{className:"loading-dot"}),(0,a.jsx)("div",{className:"loading-dot"}),(0,a.jsx)("div",{className:"loading-dot"})]})})]})}),(0,a.jsx)("div",{ref:C})]})}),(0,a.jsx)("div",{className:"glass-card-dark border-t border-white/10 px-4 py-6 relative z-10",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[P&&(0,a.jsxs)("div",{className:"mb-4 p-3 glass-card-dark border border-white/10 rounded-lg flex items-center justify-between animate-slide-up",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[P.type.startsWith("image/")?(0,a.jsxs)(a.Fragment,{children:[F&&(0,a.jsx)("img",{src:F,alt:"Preview",className:"w-16 h-16 object-cover rounded mr-3"}),(0,a.jsx)(f.Z,{className:"w-5 h-5 text-primary-400 mr-2"})]}):(0,a.jsx)(j.Z,{className:"w-5 h-5 text-primary-400 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-white font-medium",children:P.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:[(P.size/1024).toFixed(1)," KB"]})]})]}),(0,a.jsx)("button",{onClick:E,className:"icon-btn hover:bg-red-500/20",children:(0,a.jsx)(N.Z,{className:"w-4 h-4 text-red-400"})})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("textarea",{value:l,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),z())},placeholder:P?"Add a message about this file...":"Describe your event requirements...",className:"w-full input-field resize-none min-h-[80px] pr-12",disabled:k}),(0,a.jsx)("input",{ref:D,type:"file",accept:"image/jpeg,image/png,image/gif,application/pdf",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(t){if(!["image/jpeg","image/png","image/gif","application/pdf"].includes(t.type)){w.ZP.error("Please upload an image (JPEG, PNG, GIF) or PDF file");return}if(t.size>10485760){w.ZP.error("File size must be less than 10MB");return}if(A(t),t.type.startsWith("image/")){let e=new FileReader;e.onload=e=>{var s;S(null===(s=e.target)||void 0===s?void 0:s.result)},e.readAsDataURL(t)}else S(null)}},className:"hidden"}),(0,a.jsx)("button",{onClick:()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.click()},className:"absolute bottom-3 right-3 icon-btn group",disabled:k,title:"Attach image or PDF",children:(0,a.jsx)(v.Z,{className:"w-5 h-5 text-gray-400 group-hover:text-white transition-colors"})})]}),(0,a.jsx)("button",{onClick:z,disabled:!l.trim()&&!P||k,className:"btn-accent px-6 self-end group",children:(0,a.jsx)(b.Z,{className:"w-5 h-5 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500",children:[(0,a.jsx)("span",{children:"Press Enter to send, Shift+Enter for new line • Upload images or PDFs to analyze AV setups"}),(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-400 mr-2 animate-pulse"}),"AI Assistant ready"]})]})]})})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-space-900 flex items-center justify-center relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-mesh-gradient opacity-20 animate-gradient"}),(0,a.jsxs)("div",{className:"text-center relative z-10",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-4",children:"No Property Selected"}),(0,a.jsx)("p",{className:"text-gray-400 mb-6",children:"Please select a property to use the AI assistant."}),(0,a.jsx)(c(),{href:"/",className:"btn-primary",children:"Go Back"})]})]})}}},function(e){e.O(0,[722,350,774,888,179],function(){return e(e.s=22)}),_N_E=e.O()}]);